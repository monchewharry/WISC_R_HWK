ext2<-read.table("HWK2_Ext2.txt")
#ex2
k<-2
d<-ext2[((k-1)*90+1):(k*90),]
dim(d)
d1<-d[1:30,]
d2<-d[31:60,]
d3<-d[61:90,]
head(d1)
plot(d)
#from the scatter plot we can see that there are no obvious relationship between V1 AND V3.
#But they both have a clear relationship with v2.
#So,I believe there is V2 is the reponse variable.
#I first suppose X1=V1
d11<-as.data.frame(d1)
names(d11)<-c("x1","y","x2")
form1<- as.formula("y ~ 1+x1+x1:x2")
m1<-lm(form1,data=d11);summary(m1)
d21<-as.data.frame(d2)
names(d21)<-c("x1","y","x2")
form2<-as.formula("1/y ~ 1+x1+x2")
m2<-lm(form2,data=d21);summary(m2)
d31<-as.data.frame(d3)
names(d31)<-c("x1","y","x2")
form3<-as.formula("y ~ 0+x1+x2+I(x1^2)")
m3<-lm(form3,data=d31);summary(m3)
#obviously the third model is best fitted
#ex3
install.packages("SenSrivastava")
library(SenSrivastava)
head(E1.19)
library(dplyr)
group<-split(E1.19,E1.19$B)
plot(group$c[-3],main="type = c")
plot(group$p[-3],main="type = p")
plot(group$c[-3],type="l",main="type = c")
plot(group$c[-3],main="type = c")
plot(group$p[-3],main="type = p")
library(ggplot2)
ggplot(E1.19,aes(x=P,y = Price,group=B,colour=B))+ xlab("#page")+geom_line()
qplot(P,Price,data=E1.19)+
geom_smooth(aes(colour=B),method="lm",se=F)+
facet_grid(.~B,margins = T)+
labs(title="Key Graph")
qplot(P,Price,data=E1.19)+
geom_smooth(aes(colour=B),method="lm",se=F)+
facet_wrap( ~ B,scale="free_y")+
labs(title="Key Graph")
setwd("/Users/CDX/WISC_REG_WK/")
ext2<-read.table("HWK2_Ext2.txt")
#ex2
k<-2
d<-ext2[((k-1)*90+1):(k*90),]
dim(d)
d1<-d[1:30,]
d2<-d[31:60,]
d3<-d[61:90,]
head(d1)
plot(d)
#from the scatter plot we can see that there are no obvious relationship between V1 AND V3.
#But they both have a clear relationship with v2.
#So,I believe there is V2 is the reponse variable.
#I first suppose X1=V1
d11<-as.data.frame(d1)
names(d11)<-c("x1","y","x2")
form1<- as.formula("y ~ 1+x1+x1:x2")
m1<-lm(form1,data=d11);summary(m1)
d21<-as.data.frame(d2)
names(d21)<-c("x1","y","x2")
form2<-as.formula("1/y ~ 1+x1+x2")
m2<-lm(form2,data=d21);summary(m2)
d31<-as.data.frame(d3)
names(d31)<-c("x1","y","x2")
form3<-as.formula("y ~ 0+x1+x2+I(x1^2)")
m3<-lm(form3,data=d31);summary(m3)
#obviously the third model is best fitted
#ex3
#install.packages("SenSrivastava")
library(SenSrivastava)
head(E1.19)
suppressMessages(library(dplyr))
group<-split(E1.19,E1.19$B)
plot(group$c[-3],main="type = c")
plot(group$p[-3],main="type = p")
library(ggplot2)
ggplot(E1.19,aes(x=P,y = Price,group=B,colour=B))+ xlab("#page")+geom_line()
qplot(P,Price,data=E1.19)+
geom_smooth(aes(colour=B),method="lm",se=F)+
facet_wrap( ~ B,scale="free_y")+
labs(title="Key Graph")
#ex4
grocery<-read.table("/Users/dcao28/Downloads/grocery_retailer.txt",header = T)
grocery<-read.table("grocery_retailer.txt",header = T)
head(grocery)
plot(grocery)
m<-lm(Y~X1+X2+X3,data = grocery)
summary(m)
plot(resid(m))
```
setwd("/Users/CDX/WISC_REG_WK/")
ext2<-read.table("HWK2_Ext2.txt")
k<-2
d<-ext2[((k-1)*90+1):(k*90),]
dim(d)
d1<-d[1:30,]
d2<-d[31:60,]
d3<-d[61:90,]
plot(d)
d11<-as.data.frame(d1)
head(d)
d<-cbind(d,d$V1^2,d$V3^2)
plot(d)
class(d)
d<-cbind(d,d$V1^2,d$V3^2,d$V1*d$V3)
plot(d)
d<-cbind(d$V2,d$V1^2,d$V3^2,d$V1*d$V3)
plot(d)
d<-cbind(d$V2,d$V1^2,d$V3^2,d$V1*d$V3)
d<-ext2[((k-1)*90+1):(k*90),]
d<-cbind(d$V2,d$V1^2,d$V3^2,d$V1*d$V3)
plot(d)
head9d
head(d)
ext2<-read.table("HWK2_Ext2.txt")
k<-2
d<-ext2[((k-1)*90+1):(k*90),]
head(d)
plot(d)
d<-cbind(d$V2,d$V1^2,d$V3^2,d$V1*d$V3)
plot(d)
ext2<-read.table("HWK2_Ext2.txt")
plot(d)
class(d)
ext2<-read.table("HWK2_Ext2.txt")
k<-2
d<-ext2[((k-1)*90+1):(k*90),]
dim(d)
class(d)
head(d)
cbind(d$V2,d$V1^2,d$V3^2,d$V1*d$V3)
cbind(d,d$V1^2,d$V3^2,d$V1*d$V3)
plot(cbind(d,d$V1^2,d$V3^2,d$V1*d$V3)[-c(1,3)])
suppressMessages(library(broom))
d11<-as.data.frame(d1)
names(d11)<-c("x1","y","x2")
form1<- as.formula("y ~ 1+x1+x1:x2")
m1<-lm(form1,data=d11);tidy(m1)
suppressMessages(library(broom))
d11<-as.data.frame(d1)
names(d11)<-c("x1","y","x2")
form1<- as.formula("y ~ 1+x1+x1:x2")
m1<-lm(form1,data=d11);knitr::kable(tidy(m1))
suppressMessages(library(broom))
d11<-as.data.frame(d1)
names(d11)<-c("x1","y","x2")
form1<- as.formula("y ~ 1+x1+x1:x2")
m1<-lm(form1,data=d11);knitr::kable(tidy(m1))
d21<-as.data.frame(d2)
names(d21)<-c("x1","y","x2")
form2<-as.formula("1/y ~ 1+x1+x2")
m2<-lm(form2,data=d21);knitr::kable(m2)
library(SenSrivastava)
head(E1.19)
suppressMessages(library(dplyr))
group<-split(E1.19,E1.19$B)
plot(group$c[-3],main="type = c")
plot(group$p[-3],main="type = p")
plot(group$c[-3],main="type = c")
x_range<-range(E1.19$Price)
group<-split(E1.19,E1.19$B)
plot(group$c[-3],xlim=x_range,main="type = c")
plot(group$p[-3],xlim=x_range,main="type = p")
plot(group$c[-3],xlim=x_range,main="type = c")
plot(group$p[-3],xlim=x_range,main="type = p")
plot(group$c[-3],xlim=x_range,ylim=y_range,main="type = c")
y_range<-range(E1.19$P)
group<-split(E1.19,E1.19$B)
plot(group$c[-3],xlim=x_range,ylim=y_range,main="type = c")
plot(group$p[-3],xlim=x_range,ylim=y_range,main="type = p")
plot(group$c[-3],xlim=x_range,ylim=y_range,main="type = c")
plot(group$p[-3],xlim=x_range,ylim=y_range,main="type = p")
plot(group$c[-3],xlim=x_range,ylim=y_range,pch=10,main="type = c")
plot(group$p[-3],xlim=x_range,ylim=y_range,pch=11,main="type = p")
plot(group$c[-3],xlim=x_range,ylim=y_range,pch=10,main="type = c")
plot(group$p[-3],xlim=x_range,ylim=y_range,pch=11,main="type = p")
par(mfrow=c(1,2))
plot(group$c[-3],xlim=x_range,ylim=y_range,pch=10,main="type = c")
plot(group$p[-3],xlim=x_range,ylim=y_range,pch=11,main="type = p")
par(mfrow=c(2,1))
plot(group$c[-3],xlim=x_range,ylim=y_range,pch=10,main="type = c")
plot(group$p[-3],xlim=x_range,ylim=y_range,pch=11,main="type = p")
ggplot(E1.19,aes(x=P,y = Price,group=B,colour=B,shape=B))+ xlab("#page")+geom_line()
head(group#c)
head(group$c)
plot(group$c[c(2,1)],xlim=x_range,ylim=y_range,pch=10,main="type = c")
plot(group$p[c(2,1)],xlim=x_range,ylim=y_range,pch=11,main="type = p")
plot(group$c[c(2,1)],xlim=x_range,ylim=y_range,pch=10,main="type = c")
x_range<-range(E1.19$Price)
y_range<-range(E1.19$P)
group<-split(E1.19,E1.19$B)
par(mfrow=c(2,1))
plot(group$c[c(2,1)],xlim=x_range,ylim=y_range,pch=10,main="type = c")
plot(group$p[c(2,1)],xlim=x_range,ylim=y_range,pch=11,main="type = p")
y_range<-range(E1.19$Price)
x_range<-range(E1.19$P)
group<-split(E1.19,E1.19$B)
par(mfrow=c(2,1))
plot(group$c[c(2,1)],xlim=x_range,ylim=y_range,pch=10,main="type = c")
plot(group$p[c(2,1)],xlim=x_range,ylim=y_range,pch=11,main="type = p")
ggplot(E1.19,aes(x=P,y = Price,group=B,colour=B,shape=B))+ xlab("#page")+geom_line()
qplot(P,Price,data=E1.19)+
qplot(P,Price,data=E1.19)+
geom_smooth(aes(colour=B),method="lm",se=F)+
facet_wrap( ~ B,scale="free_y")+
labs(title="Key Graph")
qplot(P,Price,data=E1.19)+
geom_smooth(aes(colour=B),method="lm",se=F)+
facet_wrap( ~ B,scale="free_y")+
labs(title="Key Graph")
log(group$c$Price)
plot(group$c$P,group$c$Price)
plot(log(group$c$P),group$c$Price)
par(mfrow=1)
par(mfrow=c(1,1))
plot(log(group$c$P),group$c$Price)
plot((group$c$P),group$c$Price)
plot(log(group$c$P),group$c$Price)
qplot(P,Price,data=E1.19)+
geom_smooth(aes(colour=B),method="lm",se=F)+
facet_wrap( ~ B,scale="free_y")+
labs(title="Key Graph")
grocery<-read.table("grocery_retailer.txt",header = T)
head(grocery)
plot(grocery)
m<-lm(Y~X1+X2+X3,data = grocery)
summary(m)
knitr::kable(tidy(m))
plot(resid(m))
m<-lm(Y~X1+X2+X3,data = grocery)
knitr::kable(tidy(m))
summary(m)
plot(resid(m))
abline(h=mean(resid(m)))
plot(resid(m),type="l",main="residuals")
abline(h=mean(resid(m)))
plot(x=grocery$Y)
plot(x=grocery$Y,y=resid(m))
plot(resid(m),type="l",main="residuals")
abline(h=mean(resid(m)))
plot(x=grocery$Y,y=resid(m))
plot(x=grocery$Y,y=resid(m),main="Y vs residuals")
plot(x=grocery$X1,y=resid(m),main="X1 vs Residuals")
layout(c(1,1,1,1))
plot(x=grocery$X1,y=resid(m),main="X1 vs Residuals")
?layer
?layout
layout(matrix(c(1,1,1,1),2,2,byrow = T))
plot(x=grocery$X1,y=resid(m),main="X1 vs Residuals")
layout(matrix(c(1,2,3,4),2,2,byrow = T))
plot(x=grocery$X1,y=resid(m),main="X1 vs Residuals")
plot(x=grocery$X2,y=resid(m),main="X2 vs Residuals")
plot(x=grocery$X3,y=resid(m),main="X3 vs Residuals")
?Arithmetic
Arithmetic
k<-9074463432 %% 35
setwd("/Users/CDX/WISC_REG_WK/")
setwd("/Users/CDX/WISC_R_HWK/")
setwd("/Users/CDX/WISC_R_HWK/Regression")
boom::tidy(cor(d))
knitr::kable(tidy(cor(d)))
plot(cbind(d,d$V2^2,d$V3^2,d$V2*d$V3)[-c(2,3)])
setwd("/Users/CDX/WISC_R_HWK/Regression")
suppressMessages(library(broom))
ext2<-read.table("HWK2_Ext2.txt")
k<-9074463432 %% 35
d<-ext2[((k-1)*90+1):(k*90),]
dim(d)
d1<-d[1:30,]
d2<-d[31:60,]
d3<-d[61:90,]
knitr::kable(tidy(cor(d)))
plot(d)
pairs(d)
pairs(d)
library(car)
library(car)
scatterplot.matrix(d)
?scatterplot.matrix
scatterplot.matrix(d,spread=F)
scatterplot.matrix(d,spread=F,reg.line=F)
scatterplot.matrix(d,spread=F,reg.line=T)
scatterplot.matrix(d,spread=F)
scatterplot.matrix(d,spread=F)
scatterplotMatrix(d,spread=F)
plot(cbind(d,d$V2^2,d$V3^2,d$V2*d$V3)[-c(1,3)])
